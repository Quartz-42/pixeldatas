{% extends 'base.html.twig' %}

{% block content %}
	<div class="bg-red-600 p-6 min-h-screen">
		<div class="container mx-auto">
			<div class="bg-white shadow-lg p-6 my-8 rounded-lg w-full md:w-3/5 lg:w-2/5 mx-auto flex items-center">
				<div class="w-1/4 flex justify-center">
					<img class="w-16" src="{{ asset('/img/pokeFact.png') }}">
				</div>
				<div class="w-3/4 ml-4 text-lg md:text-base">
					<p class="font-bold text-xl italic text-gray-700">Il y a actuellement
						<span class="text-red-500">{{ pokemons|length -1 }}</span>
						Pokémons dans la collection !
					</p>
				</div>
			</div>

			<div class="mt-[60px] flex flex-col md:flex-row justify-center items-start gap-8">
				<div class="md:w-1/3 p-4 bg-white shadow-lg rounded-lg mb-8 min-h-[500px] flex flex-col">
					<h2 class="font-bold text-gray-700 mb-4 text-xl uppercase text-center">Recherche Pokémon</h2>
					<h3 class="font-semibold text-gray-700 mt-4">Par Nom</h3>
					<form id="search-form">
						<input id="search-input-name" type="search" placeholder="Nom du Pokémon..." class="rounded border border-gray-300 w-full p-2 my-4 text-gray-600">
						<h4 class="font-medium text-gray-600 mt-4">Par Type</h4>
						<select id="search-input-type" class="rounded border border-gray-300 w-full p-2 my-4">
							<option value="">-- Type --</option>
							<option value="Acier">Acier</option>
							<option value="Combat">Combat</option>
							<option value="Dragon">Dragon</option>
							<option value="Eau">Eau</option>
							<option value="Électrik">Électrik</option>
							<option value="Fée">Fée</option>
							<option value="Feu">Feu</option>
							<option value="Glace">Glace</option>
							<option value="Insecte">Insecte</option>
							<option value="Normal">Normal</option>
							<option value="Plante">Plante</option>
							<option value="Poison">Poison</option>
							<option value="Psy">Psy</option>
							<option value="Roche">Roche</option>
							<option value="Sol">Sol</option>
							<option value="Spectre">Spectre</option>
							<option value="Ténèbres">Ténèbres</option>
							<option value="Vol">Vol</option>
						</select>

						<h4 class="font-medium text-gray-600 mt-4">Par Génération</h4>
						<select id="search-input-gen" class="rounded border border-gray-300 w-full p-2 my-4">
							<option value="">-- Génération --</option>
							<option value="1">Génération 1</option>
							<option value="2">Génération 2</option>
							<option value="3">Génération 3</option>
							<option value="4">Génération 4</option>
							<option value="5">Génération 5</option>
							<option value="6">Génération 6</option>
							<option value="7">Génération 7</option>
							<option value="8">Génération 8</option>
							<option value="9">Génération 9</option>
						</select>
						<button type="button" id="reset-filters" class="mt-[46px] inline-block bg-gray-700 text-amber-400 rounded py-2 px-4 font-semibold hover:bg-gray-800 w-full">
							Réinitialiser les filtres
						</button>
					</form>
					<p id="no-results" class="hidden italic font-bold text-red-600 text-lg mt-4">Aucun Pokémon ne correspond à la recherche</p>
				</div>

				<div class="md:w-1/3 p-4 bg-white shadow-lg rounded-lg text-center min-h-[500px] flex flex-col">
					<h2 class="font-bold text-gray-700 mb-4 text-xl uppercase">Classement Pokémon</h2>
					<div class="flex justify-center flex-grow">
						<img class="w-full max-w-[350px] h-auto object-contain" src="{{ asset('img/pokemon_types_wheel.png') }}" title="Pokemon wheel">
					</div>
					<a href="{{ path('app_pokemon_ranking') }}" class="mt-4 w-full inline-block bg-gray-700 text-amber-400 rounded py-2 px-4 font-semibold hover:bg-gray-800">Accéder au classement</a>
				</div>
			</div>

			<div id="pokemon-list" class="grid gap-6 mt-[60px] sm:grid-cols-2 lg:grid-cols-5">
				{% for pokemon in pokemons %}
					{% set types = [] %}
					{% for type in pokemon.types %}
						{% set types = types|merge([type.name|lower]) %}
					{% endfor %}
					{% if pokemon.pokedex_id > 0 %}
						<div class="pokemon-card bg-white shadow-md p-4 rounded-lg hover:shadow-lg transition transform hover:scale-105" data-name="{{ pokemon.name.fr | lower }}" data-type="{{ types|join(' ') }}" data-gen="{{pokemon.generation}}">
							<div class="flex justify-between items-center mb-4">
								<h2 class="text-xl font-bold text-gray-800">{{ pokemon.name.fr }}
									{% if pokemon.sprites.gmax %}
										<span class="text-xs font-semibold bg-black text-amber-400 py-1 px-2 rounded ml-2">GMAX</span>
									{% endif %}
								</h2>
								<p class="text-sm font-bold italic text-gray-500">Pokédex n°{{ pokemon.pokedex_id }}</p>
							</div>

							<div class="flex justify-between items-center mb-4">
								<div>
									{% for type in pokemon.types %}
										<img class="w-8 inline-block mr-1" src="{{ type.image }}" title="{{ type.name }}">
									{% endfor %}
								</div>
								<a href="{{ path('app_pokemon_gen', {'generation': pokemon.generation}) }}" class="font-semibold text-red-500 underline">Gen.
									{{ pokemon.generation }}</a>
							</div>

							<div class="flex justify-center">
								<a href="{{ path('app_pokemon_details', {'name': pokemon.name.fr}) }}">
									<img src="{{ pokemon.sprites.regular }}" alt="Image de {{ pokemon.name.fr }}" class="w-4/5 mt-[-10px] transform transition hover:scale-110">
								</a>
							</div>
						</div>
					{% endif %}
				{% endfor %}
			</div>
		</div>
	</div>
{% endblock %}
