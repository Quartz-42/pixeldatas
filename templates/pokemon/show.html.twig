{% extends 'base.html.twig' %}

{% block content %}
	<div class="bg-red-600 p-6 min-h-screen">
		<div class="container mx-auto">
			<div class="bg-white shadow-lg p-6 my-8 rounded-lg w-full md:w-3/5 lg:w-2/5 mx-auto flex items-center">
				<div class="w-1/4 flex justify-center">
					<img class="w-16" src="{{ asset('/img/pokeFact.png') }}">
				</div>
				<div class="w-3/4 ml-4 text-lg md:text-base">
					<p class="font-bold text-xl italic text-gray-700">Il y a actuellement
						<span class="text-red-500">{{ pokemons|length }}</span>
						Pokémons dans la collection !
					</p>
				</div>
			</div>

			{# <div class="mt-[60px] flex flex-col md:flex-row justify-center items-start gap-8">
																																											<div class="md:w-1/3 p-4 bg-white shadow-lg rounded-lg mb-8 min-h-[500px] flex flex-col">
																																												<h2 class="font-bold text-gray-700 mb-4 text-xl uppercase text-center">Recherche Pokémon</h2>
																																												<h3 class="font-semibold text-gray-700 my-3">Par Nom</h3>
																																												<form data-controller="autosubmit" method="GET" action="{{ path('app_all_pokemon') }}" class="mb-4 flex justify-between">
																																													<input type="search" name="query" value="{{ app.request.query.get('query') }}" aria-label="Search pokemons" placeholder="-- Nom du Pokémon --" class="rounded border border-gray-300 w-full p-2 my-4" data-action="autosubmit#debouncedSubmit">
																																												</form>
																																							
																																												<form id="search-form">
																																													<h4 class="font-medium text-gray-600 mt-4">Par Type</h4>
																																													<select id="search-input-type" class="rounded border border-gray-300 w-full p-2 my-4">
																																														{% set typeDisplayed = [] %}
																																														<option value="" selected>-- Type --</option>
																																														{% for pokemon in pokemons %}
																																															{% for type in pokemon.types %}
																																																{% if type.name not in typeDisplayed %}
																																																	<option value={{type.name}}>{{type.name}}</option>
																																																	{% set typeDisplayed = typeDisplayed|merge([type.name]) %}
																																																{% endif %}
																																															{% endfor %}
																																														{% endfor %}
																																													</select>
																																							
																																													<h4 class="font-medium text-gray-600 mt-4">Par Génération</h4>
																																													<select id="search-input-gen" class="rounded border border-gray-300 w-full p-2 my-4">
																																														{% set generationDisplayed = [] %}
																																														<option value="" selected>-- Génération --</option>
																																														{% for pokemon in pokemons %}
																																															{% if pokemon.generation not in generationDisplayed %}
																																																<option value={{pokemon.generation}}>
																																																	{% set generationDisplayed = generationDisplayed|merge([pokemon.generation]) %}
																																																	Gén.
																																																	{{pokemon.generation}}
																																																</option>
																																															{% endif %}
																																														{% endfor %}
																																													</select>
																																							
																																													<button type="button" id="reset-filters" class="mt-[46px] inline-block bg-gray-700 text-amber-400 rounded py-2 px-4 font-semibold hover:bg-gray-800 w-full">
																																														Réinitialiser les filtres
																																													</button>
																																							
																																												</form>
																																							
																																												<p id="no-results" class="hidden italic font-bold text-red-600 text-lg mt-4">Aucun Pokémon ne correspond à la recherche</p>
																																											</div>
																																							
																																											<div class="md:w-1/3 p-4 bg-white shadow-lg rounded-lg text-center min-h-[500px] flex flex-col">
																																												<h2 class="font-bold text-gray-700 mb-4 text-xl uppercase">Classement Pokémon</h2>
																																												<div class="flex justify-center flex-grow">
																																													<img class="w-full max-w-[350px] h-auto object-contain" src="{{ asset('img/pokemon_types_wheel.png') }}" title="Pokemon wheel">
																																												</div>
																																												<a href="{{ path('app_pokemon_ranking') }}" class="mt-4 w-full inline-block bg-gray-700 text-amber-400 rounded py-2 px-4 font-semibold hover:bg-gray-800">Accéder au classement</a>
																																											</div>
																																										</div> #}

			<form data-controller="autosubmit" method="GET" action="{{ path('app_all_pokemon') }}" class="my-3 flex justify-between">
				<input type="search" name="query" value="{{ app.request.query.get('query') }}" aria-label="Search pokemons" placeholder="Rechercher un Pokémon par son nom ou sa génération(1,2,3...)" class="rounded border border-gray-300 w-full p-2 my-4" data-action="autosubmit#debouncedSubmit">
			</form>
			<div id="pokemon-list" class="grid gap-6 mt-5 sm:grid-cols-2 lg:grid-cols-5">
				{% for pokemon in pokemons %}
					<div class="pokemon-card bg-white shadow-md p-4 rounded-lg hover:shadow-lg transition transform hover:scale-105">
						<div class="flex justify-between items-center mb-4">
							<h2 class="text-xl font-bold text-gray-800">{{ pokemon.name }}
								{% if pokemon.spriteGmax %}
									<span class="text-xs font-semibold bg-black text-amber-400 py-1 px-2 rounded ml-2">GMAX</span>
								{% endif %}
							</h2>
							<p class="text-sm font-bold italic text-gray-500">Pokédex n°{{ pokemon.pokedexId }}</p>
						</div>

						<div class="flex justify-between items-center my-4">
							<div>
								{% for type in pokemon.types %}
									<img class="w-8 inline-block mr-1" src="{{ type.image }}" title="{{ type.name }}">
								{% endfor %}
							</div>
							<a href="{{ path('app_pokemon_gen', {'generation': pokemon.generation}) }}" class="font-semibold text-red-500 underline">Gen.
								{{ pokemon.generation }}</a>
						</div>

						<div class="flex justify-center">
							<a href="{{ path('app_pokemon_details', {'name': pokemon.name}) }}">
								<img src="{{ pokemon.spriteRegular }}" alt="Image de {{ pokemon.name }}" class="w-4/5 mt-[-10px] transform transition hover:scale-110">
							</a>
						</div>
					</div>
				{% endfor %}
			</div>
			<div class="flex items-center justify-center text-center mx-auto mt-10 space-x-4">
				{% for page in visiblePages %}
					{% if page == 1 or page == pokemons.nbPages or (page >= pokemons.currentPage - 3 and page <= pokemons.currentPage + 3) %}
						{% if page == pokemons.currentPage %}
							<span class="block py-2 px-4 bg-black text-amber-500 rounded">{{ page }}</span>
						{% else %}
							<a href="{{ pagerfanta_page_url(pokemons, page) }}" class="block py-2 px-4 bg-white text-black rounded">{{ page }}</a>
						{% endif %}
					{% endif %}
				{% endfor %}
			</div>
		</div>
	</div>
{% endblock %}
