{% extends 'base.html.twig' %}

{% if filters.active.type %}
	{% set page_title = 'Pokémons de type ' ~ filters.active.type ~ ' | PixelDatas' %}
	{% set page_description = 'Découvrez tous les Pokémons de type ' ~ filters.active.type ~ ' avec leurs statistiques, évolutions et capacités.' %}
	{% set page_keywords = 'Pokémon, ' ~ filters.active.type ~ ', type ' ~ filters.active.type ~ ', statistiques, évolutions' %}
{% elseif filters.active.generation %}
	{% set page_title = 'Pokémons de génération ' ~ filters.active.generation ~ ' | PixelDatas' %}
	{% set page_description = 'Retrouvez tous les Pokémons de la génération ' ~ filters.active.generation ~ ' avec leurs détails complets.' %}
	{% set page_keywords = 'Pokémon, génération ' ~ filters.active.generation ~ ', gen ' ~ filters.active.generation %}
{% else %}
	{% set page_title = 'Tous les Pokémons | PixelDatas' %}
	{% set page_description = 'Explorez la liste complète de tous les Pokémons avec leurs types, statistiques et évolutions.' %}
	{% set page_keywords = 'Pokémon, liste Pokémon, tous les Pokémons, Pokédex' %}
{% endif %}

{% block title %}
	{{ page_title }}
{% endblock %}
{% block meta_description %}
	{{ page_description }}
{% endblock %}
{% block meta_keywords %}
	{{ page_keywords }}
{% endblock %}

{% block content %}
	<div class="bg-red-600 p-6 min-h-screen mx-auto">

		{% include 'shared/_poke_number_html.twig' with { 
			'numberOfPokemons': pokemons.nbResults,
			'type': filters.active.type,
			'generation': filters.active.generation
		} %}

		{# RECHERCHE PAR NOM #}
		{% if filters.active.type %}
			{% set formAction = path('app_pokemon_type', {'type': filters.active.type}) %}
		{% elseif filters.active.generation %}
			{% set formAction = path('app_pokemon_gen', {'generation': filters.active.generation}) %}
		{% else %}
			{% set formAction = path('app_pokemons') %}
		{% endif %}

		<form data-controller="autosubmit" method="GET" action="{{ formAction }}" class="my-3 flex justify-between" data-turbo-frame="pokemon-list">
			<input type="search" name="query" value="{{ app.request.query.get('query') }}" aria-label="Search pokemons" placeholder="Rechercher un Pokémon..." class="rounded-lg border border-gray-300 w-full p-4 my-4" data-action="autosubmit#debouncedSubmit">
		</form>

		{# RECHERCHE AVANCEE - uniquement sur la page principale #}
		{% if not filters.active.type and not filters.active.generation %}
			{% include ('shared/_accordion.html.twig') %}
		{% endif %}

		<turbo-frame id="pokemon-list" target="_top" data-turbo-action="advance" class="aria-busy:opacity-50 aria-busy:blur-sm transition-all">

			<div id="pokemon-list" class="grid gap-3 lg:gap-4 mt-5 grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 2xl:grid-cols-6 min-[2400px]:grid-cols-8">
				{% for pokemon in pokemons %}
					{% include 'shared/_card.html.twig' %}
				{% endfor %}
			</div>

			{# pagination #}
			{% include 'shared/_pagination.html.twig' %}

		</turbo-frame>
	</div>
{% endblock %}
