{% extends 'base.html.twig' %}

{% block content %}
	<div class="bg-red-600 p-6 min-h-screen mx-auto">

		{% include 'shared/_poke_number_html.twig' with { 
			'numberOfPokemons': pokemons.nbResults,
			'type': filters.active.type,
			'generation': filters.active.generation
		} %}

		{# RECHERCHE PAR NOM #}
		{% if filters.active.type %}
			{% set formAction = path('app_pokemon_type', {'type': filters.active.type}) %}
		{% elseif filters.active.generation %}
			{% set formAction = path('app_pokemon_gen', {'generation': filters.active.generation}) %}
		{% else %}
			{% set formAction = path('app_pokemons') %}
		{% endif %}

		<form data-controller="autosubmit" method="GET" action="{{ formAction }}" class="my-3 flex justify-between" data-turbo-frame="pokemon-list">
			<input type="search" name="query" value="{{ app.request.query.get('query') }}" aria-label="Search pokemons" placeholder="Rechercher un PokÃ©mon..." class="rounded-lg border border-gray-300 w-full p-4 my-4" data-action="autosubmit#debouncedSubmit">
		</form>

		{# RECHERCHE AVANCEE - uniquement sur la page principale #}
		{% if not filters.active.type and not filters.active.generation %}
			{% include ('shared/_accordion.html.twig') %}
		{% endif %}

		<turbo-frame id="pokemon-list" target="_top" data-turbo-action="advance" class="aria-busy:opacity-50 aria-busy:blur-sm transition-all">

			<div id="pokemon-list" class="grid gap-3 lg:gap-4 mt-5 grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 2xl:grid-cols-6 min-[2400px]:grid-cols-8">
				{% for pokemon in pokemons %}
					{% include 'shared/_card.html.twig' %}
				{% endfor %}
			</div>

			{# pagination #}
			{% include 'shared/_pagination.html.twig' %}

		</turbo-frame>
	</div>
{% endblock %}
